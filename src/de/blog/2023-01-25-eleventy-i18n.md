---
title: 'Internationalisierung mit Eleventy 2.0 und Netlify'
description: 'In diesem Artikel, den ich zusammen mit einem Lightning Talk bei TheJam.dev 2023 ver√∂ffentliche, erkl√§re ich, wie Internationalisierung mit Eleventy 2.0 funktioniert und baue ein einfaches Starterprojekt auf.'
category: blogpost
key: 'eleventyi18n'
date: 2023-01-25
lastEdit: 2023-04-10
---

Ich komme aus Deutschland, lebe und arbeite aber schon lange in Spanien. Mein t√§gliches Leben ist dreisprachig, da vieles in meiner Arbeit auf Englisch stattfindet.

Als ich vor einigen Monaten meine Website (auf der du dich gerade befindest!) neu entwickelt habe, kam ich auf die Idee, die Inhalte hier auch in allen drei Sprachen zur Verf√ºgung zu stellen. Je mehr ich dar√ºber nachdachte, desto besser gefiel mir die Idee: Denn ist es nicht auch ein Beitrag zur Barrierefreiheit?
Okay, sagen wir, es ist zumindest ein Bem√ºhen um _Inclusive Design_. Als nat√ºrliche Folge vergr√∂√üere ich auch meine Reichweite.

Also habe ich mich darauf eingelassen, und dabei viel gelernt. Zum Beispiel war mir der header `accept-language` bislang unbekannt, der die vom Benutzer bevorzugte nat√ºrliche Sprache angibt.

In diesem Artikel, den ich zusammen mit meinem [Lightning Talk bei TheJam.dev 2023](https://cfe.dev/speakers/lene-saile/) ver√∂ffentliche, erkl√§re ich, wie eine grundlegende Einrichtung f√ºr die Internationalisierung mit [Eleventy](https://www.11ty.dev/) vorgenommen werden kann.

Eleventy b√ºndelt ein [Plugin speziell f√ºr diesen Zweck](https://www.11ty.dev/docs/plugins/i18n/) mit Version 2.0, das die kniffligen Dinge im Hintergrund f√ºr uns erledigt.

Mein Ziel ist es, ein mehrsprachiges Starterprojekt zu bauen, das so einfach und verst√§ndlich wie m√∂glich ist.

**Lasst uns anfangen!**

{% include "partials/toc.njk" %}

## Eleventy 2.0 installieren

Stelle zun√§chst sicher, dass [du Node.js installiert hast](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm). √úber den Befehl `npm init` im Terminal erh√§ltst du eine Datei namens `package.json`, die Metadaten zu deinem Projekt enth√§lt und deine _dependencies_ aufzeichnet.

{% aside %}Wenn sich das alles kryptisch anh√∂rt, empfehle ich dir [diese Einsteiger-Serie f√ºr den Node Package Manager npm](https://css-tricks.com/a-complete-beginners-guide-to-npm/) bei CSS Tricks. Josh Comeau hat einen ausgezeichneten Leitfaden zur [Benutzung des Terminals](https://www.joshwcomeau.com/javascript/terminal-for-js-devs/) geschrieben. {% endaside %}

Erstelle einen neuen Projektordner und wechsle dann in diesen Ordner. Ich habe mein Projekt "eleventy-i18n-starter" genannt.

Um Eleventy in deinem Projekt zu installieren, f√ºhre in der Kommandozeile folgendes aus:

```node
npm install @11ty/eleventy --save-dev
```

Wir brauchen nichts anderes zu installieren! üéâ

## Grundlegende Anpassungen

Zun√§chst erstellen wir eine [Eleventy-Konfigurationsdatei](/de/blog/organisierung-der-eleventy-config-datei/). Hier geben wir an, wo sich unsere Quelldateien befinden und wie unser Ausgabeordner hei√üen soll. Au√üerdem teile ich Eleventy mit, dass wir Nunjucks" als globale [template language](https://www.11ty.dev/docs/languages/) f√ºr unsere Markdown- und HTML-Dateien verwenden.

```js
module.exports = function (eleventyConfig) {
  return {
    dir: {
      input: 'src',
      output: 'dist'
    },
    markdownTemplateEngine: 'njk',
    htmlTemplateEngine: 'njk'
  };
};
```

Als N√§chstes erstelle den Eingabeordner `src` und darin zwei Ordner namens `_data` (den werden wir sp√§ter brauchen) und `_includes`. Innerhalb von `_includes` f√ºge eine Datei namens `base.njk` hinzu. Sie enth√§lt unser Hauptlayout:

`base.njk`:
{% raw %}

```html
<!DOCTYPE html>
<html lang="" dir="">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>{{ title }}</title>

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/kimeiga/bahunya/dist/bahunya.min.css"
    />

    <link rel="canonical" href="{{ meta.url }}{{ page.url }}" />
    <meta name="description" content="{{ description }}" />
  </head>

  <body>
    {% include "header.njk" %}
    <main>
      <h1>{{ title }}</h1>
      {{ content | safe }}
    </main>

    {% include "footer.njk" %}
  </body>
</html>
```

{% endraw %}

F√ºr unser einfaches Beispiel brauchen wir nur ein [Layout](https://www.11ty.dev/docs/layouts/), das wir zum Einbetten aller Inhalte verwenden.

Ich habe nur einige sehr grundlegende und unbedingt erforderliche Details im Bereich `head` angelegt.
Der `title`-tag und die meta-`description` werden aus unseren Markdown-Vorlagendateien gezogen, f√ºr das Styling verwende ich ein CSS-Framework auf einem CDN.

Die Landmarke `main` enth√§lt unseren Inhalt, der aus Markdown-Dateien generiert wird. Damit es nicht zu un√ºbersichtlich wird, lagere ich die "landmarks" `header` und `footer` in Layout-Teilbereiche aus.

Lege `header.njk` und `footer.njk` im selben Ordner an und lass beide Dateien einfach erstmal leer.

Um Eleventy mit einem schnellen Befehl starten zu k√∂nnen, f√ºgen wir das CLI-Skript in den Abschnitt "scripts" der `package.json` ein.

`package.json`:

```js
  "scripts": {
    "start": "eleventy --serve --watch",
    "build": "eleventy"
  },
```

{% aside %}F√ºr den `start`-Befehl habe ich sogenannte "flags" gesetzt. `--serve` startet Eleventy's eigenen Entwicklungsserver und `--watch` achtet auf Datei-√Ñnderungen. Beide sind f√ºr die lokale Entwicklung gedacht. Es gibt noch mehr hilfreiche flags, lies mehr √ºber die [Kommandozeilen-Nutzung in den Eleventy Docs](https://www.11ty.dev/docs/usage/).{% endaside %}

## Internationalisierung und Lokalisierung

Bevor wir weitermachen, m√ºssen wir einen kurzen Blick auf die Begriffe Internationalisierung (auch bekannt als "i18n") und Lokalisierung ("l10n") werfen, auf die man zwangsl√§ufig st√∂√üt.

### Lokalisierung

Die Lokalisierung zielt darauf ab, Inhalte in einen strukturell und sprachlich korrekten Kontext f√ºr ein bestimmtes Gebiet zu setzen.

Lokalisierungen werden durch ISO-Sprachcodes umschrieben, die sich aus einer Basissprache und dem Land (Gebiet), in dem sie verwendet wird, zusammensetzen.

Am Beispiel von Deutsch gibt es die folgenden Sprachcodes:

`de`
: Deutsch

`de-AT`
: Deutsch (√ñsterreich)

`de-CH`
: Deutsch (Schweiz)

`de-DE`
: Deutsch (Deutschland)

`de-LI`
: Deutsch (Liechtenstein)

`de-LU`
: Deutsch (Luxemburg)

Im Rahmen des Lokalisierungsprozesses werden Inhalte √ºbersetzt, der Tonfall an die jeweilige Kultur angepasst, W√§hrungen und Ma√üeinheiten der jeweiligen Region hinzugef√ºgt, oder Multimedia-Inhalte so angepasst, dass die Botschaft in dem jeweiligen kulturellen Kontext korrekt vermittelt wird.

Im Rahmen dieses Artikels befassen wir uns vor allem mit der Internationalisierung.

### Internationalisierung

Bei der Internationalisierung bereitest du deinen Code auf die Anforderungen der verschiedenen Sprachumgebungen und den gesamten Lokalisierungsprozess vor.

Wir wollen zum Beispiel sicherstellen, dass Sprachen mit einer Rechts-nach-Links-Schreibweise vom CSS korrekt behandelt werden, oder dass Textinhalte aus verschiedenen Sprachen unterschiedlich viel Platz einnehmen k√∂nnen, ohne das Design zu zerst√∂ren. Lange deutsche W√∂rter sind ber√ºchtigt!

Um das zu illustrieren habe ich eine Liste langer deutscher W√∂rter f√ºr euch, die ich im Laufe der Jahre gesammelt habe. Endlich ist sie f√ºr etwas zu gebrauchen:

<details>
<summary>Lange Liste mit langen deutschen W√∂rtern</summary>
<div  id="wordlist">

- Pfarrgemeinderatsmitglied
- Liegenschaftskataster
- Kunstfahndungsdienststelle
- Nichtregierungsorganisationen
- Mobilfunkanrufaufzeichnungen
- S√§belscheidenschienbein
- Strukturentwicklungszulagen
- nordwestmecklenburgisch
- Unabh√§ngigkeitsreferendum
- Junggesellinnenabschiedsparty
- Reiseschn√§ppchenportal
- Selbstverwirklichungsversprechen
- Unabh√§ngigkeitsbestrebungen
- Nachwuchsunternehmerin
- Desinformationskampagne
- Bundesprogrammkommission
- Hauptstadtb√ºroleiterin
- Altmedienbesitzstandswahrung
- Weltanschauungsvereinigungen
- aufmerksamkeits√∂konomisch
- Majest√§tsbeleidungsparagrafen
- Zweckentfremdungsverbot
- Suchmaschinenergebnisseiten
- Lebensmittelverteilungszentrum
- Rassekaninchenz√ºchterverein
- Bundespsychotherapeutenkammer
- Auslandsdirektinvestitionen
- Nachwuchsleistungszentren
- Wildwasserkajakstrecke
- Satellitenbeobachtungsprogramm
- Onlinelebensmittellieferdienst
- Jahresdurchschnittstemperaturen
- Androgenisierungserscheinungen
- Urananreicherungszentrum
- Senatsuntersuchungsausschuss
- Energieforschungskooperationen
- Antiglobalisierungstendenzen
- Renationalisierungstendenzen
- Eiskunstlaufenthusiastinnen
- Antikorruptionsstaatsanw√§ltin
- Selbstzerfleischungsprozess
- Unterbringungsm√∂glichkeiten
- Heimatschutzministerium
- Verkehrs√ºberwachungsma√ünahmen
- Geschwindigkeitsbegrenzungsschild
- Kunsthandwerkergenossenschaft
- Fruchstaftgetr√§nkehersteller
- Wahlkampffinanzierungsgesetze
- Unabh√§ngigkeitsbef√ºrworterin
- Vizepr√§sidentschaftskandidatin
- Geldw√§scheverdachtsmeldungen
</div>
 </details>

Eine ernsthafte Internationalisierung und Lokalisierung ist keine leichte Aufgabe.

Auf meiner pers√∂nlichen Website (und im Rahmen dieses Projekts) nehme ich mir die Freiheit zu bestimmen, dass es nur _eine_ englische oder spanische Sprache f√ºr alle Besucher gibt, so dass die Leser es hinnehmen m√ºssen, dass ich arglos britisches und amerikanisches Englisch in Rechtschreibung und Audruck vermische, weil ich es einfach nicht besser wei√ü.

Wie auf dieser Website hier, verwende ich f√ºr das Startprojekt Englisch, Spanisch und Deutsch, weil ich diese Sprachen beherrsche und automatischen √úbersetzungen nicht traue. Ansonsten w√§re eine RTL-Sprache nat√ºrlich gut gewesen.

{% aside %}Bitte f√ºhl dich frei, weitere Sprachen per Pull-Request zum [Starter-Projekt, das wir erstellen](https://github.com/madrilene/eleventy-i18n) hinzuzuf√ºgen, besonders wenn es sich um eine RTL-Sprache handelt.{% endaside %}

Beginnen wir damit, uns eine Struktur f√ºr unsere drei Sprachen zu √ºberlegen!

## Beispiele f√ºr lokalisierte URLs

Es gibt verschiedene M√∂glichkeiten, Identifikatoren in die URLs einzubauen.

Du kannst l√§nderspezifische Domains kaufen (`deinewebsite.es`), Subdomains einrichten (`es.deinewebsite.com`), URL-Parameter hinzuf√ºgen (`deinewebsite.com?lang=es`) oder lokalisierte Unterverzeichnisse erstellen (`deinewebsite.com/es`).

Bei Google Search Central wurde [eine Tabelle mit einigen Vor- und Nachteilen](https://developers.google.com/search/docs/specialty/international/managing-multi-regional-sites#locale-specific-urls) zusammengstellt.

Eleventy kompiliert auf der Grundlage der Ordnerstruktur, so dass lokalisierte Unterverzeichnisse perfekt funktionieren. Dies ist auch die [von Eleventy empfohlen Vorgehensweise](https://www.11ty.dev/docs/i18n/).

### Explizite und implizite Lokalisierung

Als n√§chstes m√ºssen wir √ºberlegen, ob wir _explizit_ oder _implizit_ lokalisierte Unterverzeichnisse haben wollen. Das hei√üt, wollen wir einen aus zwei Buchstaben bestehenden Gebietsschema-Code f√ºr _alle_ Sprachen in der URL (explizit), oder soll unsere Hauptsprache in der URL ohne Kennung angezeigt werden (implizit)?

Beide Varianten sind m√∂glich. Wenn du eine sehr eindeutige Hauptsprache auf der Website hast und vielleicht nicht alle Inhalte √ºbersetzen willst, ist es sinnvoll, keinen Sprachcode in der URL f√ºr deine Hauptsprache anzuzeigen. In den [Docs des Plugins](https://www.11ty.dev/docs/i18n/#distinct-urls-using-implied-default-language) wird erkl√§rt, wie man das so einrichtet.

Auf meiner Website sind alle Inhalte √ºbersetzt. Und obwohl ich Englisch als Hauptsprache betrachte, sind mir alle drei Sprachen gleich wichtig. Deshalb habe ich mich f√ºr das explizite Schema entschieden - und so wollen wir es auch in diesem Startprojekt machen.

## Erstellen der Ordnerstruktur

F√ºgen wir drei Ordner hinzu, die nach dem zweistelligen ISO-Code jeder Sprache benannt sind, und erstellen wir in jedem Ordner eine Datei namens `index.md`.

Unsere Ordnerstruktur sieht nun wie folgt aus:

{% raw %}

<!-- prettier-ignore -->
```md
‚îÇ
‚îú‚îÄ‚îÄ src
‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ _data
‚îÇ  ‚îú‚îÄ‚îÄ _includes
‚îÇ  ‚îú‚îÄ‚îÄ de
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ index.md
‚îÇ  ‚îú‚îÄ‚îÄ en
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ index.md
‚îÇ  ‚îú‚îÄ‚îÄ es
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ index.md
‚îÇ
```

{% endraw %}

Wir f√ºgen in jede Datei einige lokalisierte Inhalte ein:

**`en/index.md`:**

```md
---
title: 'English Page'
description: 'This is the english version of the homepage'
---

This is a minimal starter for localized content with Eleventy.
```

**`de/index.md`:**

```md
---
title: 'Deutsche Seite'
description: 'Dies ist die deutsche Version der Startseite'
---

Dies ist ein minimaler Starter f√ºr lokalisierte Inhalte mit Eleventy.
```

**`es/index.md`:**

```md
---
title: 'P√°gina en espa√±ol'
description: 'Esta es la versi√≥n en espa√±ol de la p√°gina inical'
---

Este es un starter m√≠nimo para contenido localizado con Eleventy.
```

Wenn wir die Permalink-Struktur in Eleventy nicht √§ndern, wird unsere Ordnerstruktur im Eingabeverzeichnis unver√§ndert √ºbernommen. Die Datei "index.md" wird dabei als "root" des Sprachverzeichnisses erkannt und direkt als "index.html" √ºbertragen.

F√ºgen wir nun eine Unterseite hinzu, die klassische "√úber mich" Seite, und f√ºgen auch hier lokalisierte Inhalte hinzu.

Ich nenne diese Seite in beiden Sprachen `about.md`. Das hat verschiedene Vorteile:

- Das Eleventy i18n-Plugin erkennt die zusammengeh√∂rigen Seiten
- alle Seiten werden in der gleichen Reihenfolge angezeigt
- es h√§lt mein Startprojekt so schlank und einfach wie m√∂glich.

Wenn wir in unserem Ausgabeordner schauen, sehen wir, dass nun drei neue Unterordner erstellt wurden, die alle "about" hei√üen.

{% raw %}

<!-- prettier-ignore -->
```md
‚îÇ
‚îú‚îÄ‚îÄ dist
‚îÇ  ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ de
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ index.html
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ about
‚îÇ  ‚îÇ     ‚îî‚îÄ‚îÄ index.html
‚îÇ  ‚îú‚îÄ‚îÄ en
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ index.html
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ about
‚îÇ  ‚îÇ     ‚îî‚îÄ‚îÄ index.html
‚îÇ  ‚îú‚îÄ‚îÄ es
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ index.html
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ about
‚îÇ  ‚îÇ     ‚îî‚îÄ‚îÄ index.html
‚îÇ
```

{% endraw %}

Beachte dass dies finale Struktur unserer Webseite darstellt, dass der Link f√ºr die deutsche "√úber mich"-Seite also folgenderma√üen auss√§he: `www.mywebsite.com/de/about`

### Lokalisierte URL-Slugs

Ich ziehe es vor, dass die Sprachen in sich konsistent sind. Passen wir also die Permalinks an.

**`de/about.md`:**

```md
---
title: '√úber mich'
description: 'Eine deutsche Unterseite'
permalink: /de/ueber-mich/index.html
---

Ich bin Webentwicklerin und Designerin, geboren in Berlin, zu Hause in Madrid.
```

Wenn du das automatisieren und intuitiver machen willst, gibt es eine clevere L√∂sung, die ich im [Eleventy Base Blog](https://github.com/11ty/eleventy-base-blog/tree/v2) gefunden habe.

Du musst daf√ºr [Parent Directory Data Files](https://www.11ty.dev/docs/data-template-dir/) innerhalb aller lokalisierten Unterordner hinzuf√ºgen.

Hier wird die jeweilige Sprache im Permalink angegeben und es wird gepr√ºft, ob ein optionaler Frontmatter-Dateneintrag im Template vorhanden ist, der zu einem "slug" umgewandelt wird. "Slugifiziert"? üò∂

**`es/es.11tydata.js`:**

```js
module.exports = {
  lang: 'es',
  permalink: function (data) {
    // Slug override for localized URL slugs
    if (data.slugOverride) {
      return `/${data.lang}/${this.slugify(data.slugOverride)}/`;
    }
  }
};
```

**`es/about.md`:**

```md
---
title: 'Sobre m√≠'
description: 'Una subp√°gina en espa√±ol'
slugOverride: sobre mi
---

Soy una desarrolladora y dise√±adora nacida en Berl√≠n, viviendo en Madrid.
```

In unserem Fall k√∂nnten wir nur den Titel "slugifizieren", aber ich ziehe es vor, diese Dinge getrennt zu behandeln, damit ich den Titel-String anpassen kann, w√§hrend der Permalink aber unver√§ndert bleibt.

### Trennung von Code und √úbersetzung

Um zu verstehen, wie das alles funktioniert, ist es wichtig, in [Eleventys Data Cascade](https://www.11ty.dev/docs/data-cascade/) einzutauchen.

Wir wollen immer ==den Code von der √úbersetzung trennen==. Wir trennen bereits Code und Inhalt: Unser Code befindet sich in Layout-Dateien (in diesem Fall einfach `base.njk`), und unsere Inhalte werden von Markdown in Template-Dateien erstellt. Wir m√ºssen auch einige lokalisierte _strings_ f√ºr das Layout speichern. Man k√∂nnte sie im Frontmatter der Layout-Datei speichern, aber ich ziehe es vor, alles an einem Ort zu haben.

Hier kommen die globalen Daten ins Spiel!

## Globale Daten

Im Ordner `_data` legen wir alles ab, was in unserem Projekt global verf√ºgbar sein soll. G√ºltig sind alle `*.json` und `module.exports` Werte aus `*.js` Dateien.

Erstelle die folgenden Datendateien:

`meta.js`:

```js
// holds all our meta data
module.exports = {
  url: process.env.URL || 'http://localhost:8080',
  siteName: '18n-starter',
  siteDescription:
    "Minimal starter for localized content, using Eleventy's own Internationalization (I18n) plugin"
};
```

`languages.js`:

```js
// same locale codes as in your localized subdirectories
module.exports = {
  en: {
    dir: '', // stands for the direction of the language set in the head, defaults to LTR (left to right)
    availableText: 'This page is also available in:'
  },
  de: {
    availableText: 'Diese Seite ist auch verf√ºgbar in:'
  },
  es: {
    availableText: 'Esta p√°gina tambi√©n est√° disponible en:'
  }
};
```

`layout.js`:

```js
// sets a global layout for all templates, can be overwritten later in the Eleventy Data Cascade
module.exports = 'base.njk';
```

`navigation.js`:

```js
// just my personal preference for creating navigation in Eleventy
module.exports = {
  en: [
    {
      text: 'Home',
      url: '/en/'
    },
    {
      text: 'About me',
      url: '/en/about-me/'
    }
  ],
  de: [
    {
      text: 'Startseite',
      url: '/de/'
    },
    {
      text: '√úber mich',
      url: '/de/ueber-mich/'
    }
  ],
  es: [
    {
      text: 'Inicio',
      url: '/es/'
    },
    {
      text: 'Sobre mi',
      url: '/es/sobre-mi/'
    }
  ]
};
```

Ich versuche immer, unn√∂tige Komplexit√§t zu vermeiden. Ich lege alle meine lokalisierten _strings_ in meinem _global data_ Ordner in der Datei `languages.js` ab und greife auf sie mittels _dot notation_ zu.

Wenn ich weitere lokalisierte strings ben√∂tige, f√ºge ich sie einfach dort hinzu. Das Gleiche gilt f√ºr die Navigation. Ich m√∂chte maximale Kontrolle dar√ºber haben, welche Seiten ich wo anzeige und wie sie im Men√º hei√üen sollen.

## Verwendung des Eleventy Internationalisierungs-Plugins

Um das mitgelieferte i18n-Plugin zu aktivieren, f√ºge es zu deiner `eleventy.js` hinzu:

```js
const {EleventyI18nPlugin} = require('@11ty/eleventy');

module.exports = function (eleventyConfig) {
  eleventyConfig.addPlugin(EleventyI18nPlugin, {
    defaultLanguage: 'en' // Required
  });

  // other settings
};
```

Wir m√ºssen eine Standardsprache angeben. Ich habe Englisch gew√§hlt, aber es kann jede Sprache sein: `defaultLanguage: 'en'`

Das Plugin bietet uns eine Erg√§nzung zur [page variable](https://www.11ty.dev/docs/data-eleventy-supplied/#page-variable) (`page.lang`) sowie zwei neue [universelle Filter](https://www.11ty.dev/docs/filters/#universal-filters) (`locale_url` und `locale_links`) f√ºr die g√§ngigsten Template-Sprachen.

Werfen wir zun√§chst einen Blick auf `page.lang`.

### Verwendung des "language tags" f√ºr das aktuelle Template

`page.lang` stellt das "language tag" f√ºr das aktuelle Seiten-Template dar und wird standardm√§√üig auf den Wert gesetzt, den wir als `defaultLanguage` im Plugin angegeben haben.

Zun√§chst verwenden wir es f√ºr das html `lang`-Attribut und um auf den Richtungswert (`dir`) zuzugreifen, der in `languages.js` gesetzt werden kann.

`base.njk`:

{% raw %}

```html
<!DOCTYPE html>

<html lang="{{ page.lang }}" dir="{{ languages[page.lang].dir or 'ltr' }}">
  <!-- rest of the template -->
</html>
```

{% endraw %}

Es nimmt den lokalisierten Verzeichnisnamen und legt ihn als Sprache des aktuellen Dokuments fest. Im Falle des Attributs `dir` "loopt" es durch die Datei `languages.js` in `_data` und erh√§lt die entsprechende Richtung (RTL oder, als Fallback, LTR).

**Das ist sehr wichtig.**

Das `lang`-Attribut wird verwendet, um die Sprache eines Elements zu definieren. ==Es wird von Screenreadern verwendet, um den richtigen Akzent und die richtige Aussprache zu gew√§hrleisten==, der User-Agent kann die richtigen Glyph-Varianten und Anf√ºhrungszeichen, Silbentrennung, Ligaturen und Abst√§nde ausw√§hlen.
Wie alles im Bereich der Barrierefreiheit kommt dies auch den Suchmaschinen zugute.

{% aside %}Im [Learn Accessibility](https://web.dev/learn/accessibility/more-html/#page-language) Kurs erfuhr ich, dass es empfohlen wird, zweistellige ISO-Sprachcodes zu verwenden, um eine gr√∂√üere _Assistive technology_ Abdeckung zu erreichen, da viele von ihnen keine erweiterten Sprachcodes unterst√ºtzen.{% endaside %}

In diesem Fall legen wir die Sprache des gesamten Dokuments fest, aber du kannst die Sprache auch f√ºr jedes beliebige Element festlegen, z.B. `<p lang="fr">Bonjour mon ami</p>`, _innerhalb_ eines Dokuments, das in einer anderen Sprache geschrieben ist.

Als N√§chstes verwenden wir es f√ºr unsere Navigation im `header` und als einfachen Sprachumschalter im `footer`.

`header.njk`:

{% raw %}

```html
{% set activePage = page.url %}

<header>
  <nav aria-label="Primary">
    <ul>
      {% for item in navigation[page.lang] %}
      <li>
        <a href="{{ item.url }}">{{ item.text }}</a>
      </li>
      {% endfor %}
      <li>
        <a href="https://github.com/madrilene/eleventy-i18n">GitHub</a>
      </li>
    </ul>
  </nav>
</header>
```

{% endraw %}

Diese Komponente durchl√§uft unsere globale Navigationsdatei und zeigt auf der Grundlage des durch `page.lang` festgelegten Wertes das Men√º in der aktuellen Sprache an.

{% aside %}Im fertigen Starterprojekt habe ich eine [Hilfsfunktion](https://github.com/madrilene/eleventy-i18n/blob/main/src/_data/helpers.js) erg√§nzt, um `aria-current="page"` zur aktuellen Seite hinzuzuf√ºgen.
{% endaside %}

`footer.njk`:

{% raw %}

<!-- prettier-ignore -->
```html
<footer>
  {{ languages[page.lang].availableText }}

  {% for link in page.url | locale_links %} {%-if not loop.first %}/{% endif %}
  <a href="{{ link.url }}" lang="{{ link.lang }}" hreflang="{{ link.lang }}"
    >{{ link.label }}</a
  >
  {% endfor %}
</footer>
```

{% endraw %}

Im `footer` machen wir zuerst einen Loop durch `languages.js`, um den String in der aktuellen Sprache zu erhalten, dann verwenden wir den ersten der neu verf√ºgbaren Universalfilter: `locale_links`.

### Verwendung des 'locale_links' Filters

`locale_links` gibt ein Array mit den alternativen Sprachversionen f√ºr eine bestimmte URL zur√ºck. Die urspr√ºngliche Seite, die dem Filter √ºbergeben wurde, ist dort nicht enthalten.
Wenn man dieses Array in einem Loop durchl√§uft, erh√§lt man einen einwandfreien Sprachumschalter!

Du kannst auch einen Sprachumschalter mit zweistelligen Locale-Codes erstellen, der die aktuelle Sprache zuerst anzeigt:

{% raw %}

<!-- prettier-ignore -->
```html
<!-- alternative language switcher -->
<footer>
  <nav>
    <a href="{{ page.url }}" lang="{{ page.lang }}" hreflang="{{ page.lang }}">
      {{ page.lang | upper }}
    </a>

    {% for link in page.url | locale_links %}
    <a href="{{ link.url }}" lang="{{ link.lang }}" hreflang="{{ link.lang }}">
      {{ link.lang | upper }}</a
    >
    {% endfor %}
  </nav>
</footer>
```

{% endraw %}

Im Element `head` in `base.njk` teilen wir dem User-Client mit, dass es ==alternative Versionen des aktuellen Dokuments== gibt. Das Attribut `hreflang` gibt an, in welcher Sprache die verlinkte Ressource vorliegt.

{% aside %}[√Ålvaro Montoro](https://alvaromontoro.com/) schrieb einen [ausgezeichneten Artikel √ºber das `rel`-Attribut](https://www.htmhell.dev/adventcalendar/2022/21/#meta-types) im HTMHell-Adventskalender 2022. {% endaside %}

Beachte, dass jede Sprachversion sowohl sich selbst als auch alle anderen Sprachversionen auflisten muss. [Alternative URLs m√ºssen _fully-qualified_ sein](https://developers.google.com/search/docs/specialty/international/localized-versions#all-method-guidelines), einschlie√ülich der Transportmethode - also `http` oder `https`.

Wir f√ºgen zuerst das Link-Attribut zur aktuellen URL hinzu, dann loopen √ºber die alternativen Versionen.

`base.njk`:

{% raw %}

<!-- prettier-ignore -->
```html
<!-- stylesheet here -->

<link rel="alternate" hreflang="{{ page.lang }}" href="{{ meta.url }}{{ page.url }}" />

    {% for link in page.url | locale_links %}
    <link
      rel="alternate"
      hreflang="{{ link.lang }}"
      href="{{ meta.url }}{{ link.url }}"
    />
    {% endfor %}

<!-- Canonical URL here -->

```

{% endraw %}

Es gibt noch einen weiteren Filter, √ºber den wir noch nicht gesprochen haben.

### Verwendung des 'locale_url' Filters

In den Worten der Eleventy-Dokumentation ausgedr√ºckt, akzeptiert `locale_url` eine beliebige URL-Zeichenkette und wandelt sie unter Verwendung des Lokalisierungscodes der aktuellen Seite um. Funktioniert wie erwartet, wenn die URL bereits einen Sprachcode enth√§lt. Dies ist besonders n√ºtzlich bei gemeinsam genutztem Code, der von internationalisierten Inhalten verwendet wird (Layouts, Partials, Includes usw.).

In unserem Startprojekt brauchen wir es nicht, aber stell dir vor, du verwendest es als Layout-Teil f√ºr einen _call to action_, der den Besucher z. B. auf die lokalisierte Blog-Seite schickt.

{% raw %}

```html
<a href="{{ "/blog/" | locale_url }}">Blog</a>
```

{% endraw %}

Es scheint aber nur zu funktionieren, wenn man die Permalinks nicht ver√§ndert, deshalb mache ich im Moment keinen Gebrauch davon.

## Weitere Anpassungen der Barrierefreiheit

Wir m√ºssen einige wichtige Anpassungen in Bezug auf die Barrierefreiheit vornehmen. Navigations-"Landmarks" (`nav`) sollten eine Beschriftung (label) haben, und diese Beschriftungen m√ºssen ebenfalls √ºbersetzt werden. Das gleiche gilt f√ºr den Link um die Navigation zu √ºberspringen (f√ºr Keyboard Navigation).
Beide Zeichenfolgen k√∂nnen in `languages.js` gesetzt werden.

Du kannst das im GitHub Repo f√ºr die [`header.njk`](https://github.com/madrilene/eleventy-i18n/blob/main/src/_includes/header.njk) und [`languages.js`](https://github.com/madrilene/eleventy-i18n/blob/main/src/_data/languages.js) umgesetzt finden.

## Umleitung des Besuchers zu seinem bevorzugten Sprachverzeichnis

Bevor wir unseren Code auf einer Live-Site verwenden k√∂nnen, m√ºssen wir noch ein sehr wichtiges Detail anpassen.

Im Moment erhalten wir eine 404 in der URL-Root, da wir die Besucher noch nicht zu ihren bevorzugten Sprachverzeichnissen umleiten.

### Wie wird die bevorzugte Sprache ermittelt?

Die sprachbasierten Weiterleitungen, die wir einrichten, werden mit der ==ersten Sprache abgeglichen, die der Browser im `Accept-Language`-Header angibt.

Dies kann in den Voreinstellungen des Browsers angepasst werden. Wenn du deine IP-Adresse nicht verschleierst, erf√§hrt der Benutzer-Client au√üerdem, wo du dich auf Landesebene befindest.

Theoretisch k√∂nnte ich mich selbst als deutschsprachige Person mit Wohnsitz in Spanien ansprechen und einige sehr spezifische Inhalte f√ºr diesen Anwendungsfall anzeigen lassen, solange ich diese Information an meinen Browser weitergebe. Richtig?

In den Developer Tools kannst du auf der Registerkarte Netzwerk sehen, welche Werte eingestellt sind. Meine verschiedenen Browser haben unterschiedliche Einstellungen, aber eine meiner eine Chrome-Instanzen zeigt mir dies:

Wie du siehst, ist es keine gute Idee, Leute auf der Grundlage dieser Indikatoren anzusprechen.
Meine bevorzugte Sprache ist auf (britisches) Englisch eingestellt.

{% aside %}Der bevorzugten Sprache folgt die Syntax des _Qualit√§tswertes_ (`q=0.x`). [Lies mehr √ºber all das auf MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Language)
{% endaside %}

In unserem Projekt wollen wir nicht nur eine einfache M√∂glichkeit f√ºr Benutzer bieten, zu ihrer tats√§chlich bevorzugten Sprache zu wechseln, sondern auch immer zu einer Basissprache zur√ºckkehren (falls die bevorzugte Sprache des Besuchers z. B. auf Franz√∂sisch eingestellt ist).

## Regeln f√ºr die Weiterleitung mit Netlify festlegen

Im Rahmen unseres Beispielprojekts arbeiten wir mit [Netlify Hosting](https://www.netlify.com/).

Netlify bietet eine einfache Implementierung f√ºr Redirect-Regeln, entweder √ºber die Datei `_redirects` oder √ºber die Netlify-Konfigurationsdatei.

Ich pers√∂nlich ziehe es vor, die `_redirects`-Datei nur f√ºr [automatisierte interne Weiterleitungen](https://eleventy-excellent.netlify.app/blog/post-with-301-redirects/) zu verwenden, wenn eine Seite dauerhaft den Standort gewechselt hat (eine Art _separation of concerns_).

Da ich ohnehin eine Netlify-Konfigurationsdatei (`netlify.toml`) erstelle, um anzugeben, welches mein Ausgabeverzeichnis und welches mein Build-Skript ist, lege ich meine drei sprachbasierten Weiterleitungen ebenfalls dort ab. Ich mag auch die saubere Syntax!

`netlify.toml`:

<!-- prettier-ignore -->
```md
# tell netlify about your build script and output directory

[build]
  command = "npm run build"
  publish = "dist"

# redirect to english, spanish or german landing pages

[[redirects]]
  from = "/"
  to = "/de"
  status = 302
  force= true
  conditions = {Language = ["de"]}

[[redirects]]
  from = "/"
  to = "/es"
  status = 302
  force = true
  conditions = {Language = ["es"]}

[[redirects]]
  from = "/"
  to = "/en"
  status = 302
  force = true

```

Wir leiten im Root-Verzeichnis auf der Grundlage der bevorzugten Sprache um - derjenigen, die an erster Stelle im `Accept-Language` header steht (`conditions = {Language = ["de"]}`). Dies ist ein Array, so dass du mehrere Werte setzen kannst.

Lege so viele Umleitungen fest, wie du Sprachen erstellt hast. Die letzte sollte die Fallback-Sprache sein, d.h. die Sprache, die du als `defaultLanguage` im i18n-Plugin eingestellt hast.

{% aside %}In den Netlify Docs](https://docs.netlify.com/routing/redirects/) kannst du [mehr dar√ºber lesen, z.B. welche HTTP-Statuscodes welche Auswirkungen haben, oder wie man 404-Fehlerseiten f√ºr alle Sprachen korrekt erstellt und umleitet. Es gibt auch ein [spezielles Kapitel zu diesem Thema in der Jamstack Explorers-Videoserie](https://explorers.netlify.com/learn/exploring-netlify-redirects/localization-with-conditional-redirects).{% endaside %}

## Schlussbemerkungen

Das Projekt ist bereit f√ºr Deployment!

Meine bevorzugte Vorgehensweise ist es, ein [neues Repo auf GitHub](https://docs.github.com/en/get-started/quickstart/create-a-repo) zu erstellen und [es auf Netlify einzulesen](https://www.youtube.com/watch?v=4h8B080Mv4U).

Es gibt noch viele Dinge, die fehlen. Zum Beispiel brauchst du vielleicht lokalisierte [collections](https://www.11ty.dev/docs/collections/) und einen lokalisierten Datumsfilter f√ºr deinen Blog.

Ich wollte diesen Starter so einfach und √ºberschaubar wie m√∂glich halten. Man kann viele Prozesse verfeinern und automatisieren, sei es die Navigation, die Permalinks oder die Unterseiten der jeweiligen Sprachen, die auch √ºber Frotnmatter-keys einander zugeordnet werden k√∂nnen, anstatt denselben Ordnernamen zu verwenden.

Leider hatte CSS in diesem Artikel keinen Platz. Bitte ersetze das CDN-Stylesheet durch dein eigenes, es dient nur dazu, ein einigerma√üen ansprechendes Erscheinungsbild zu erreichen, ohne dass CSS-Klassen notwendig sind.

### Eine kleine CSS-Erw√§hnung

Die Pseudoklasse `:lang` ordnet Elemente auf der Grundlage der Sprache zu, in der sie sich befinden. Eine wirklich sch√∂ne M√∂glichkeit, den Sprachen eine eigene gestalterische Note zu geben!

```css
nav:lang(de) {
  background-color: darkseagreen;
}
```

_Logical properties_ bieten automatische Unterst√ºtzung f√ºr die Internationalisierung und helfen dir dabei stabile und inklusive Frontends zu bauen. Ich empfehle [das Kapitel dazu auf web.dev (Learn CSS)](https://web.dev/learn/css/logical-properties/).

```css
.element {
  padding-block-start: 2em;
  padding-block-end: 2em;
}
```

### Repository "forken"

Du kannst die Repository [forken](https://github.com/madrilene/eleventy-i18n), die ich zusammen mit dem Artikel erstellt habe. Ich habe einige zus√§tzliche Funktionen hinzugef√ºgt, wie z.B. ein Hilfsskript, das Screenreadern die aktuelle Seite anzeigt, Weiterleitungen zu lokalisierten 404-Seiten und globale Datenstrings f√ºr verbesserte Barrierefreiheit (√ºbersetzte Aria-Labels, skip-link...). Um Rendering-Blockaden zu vermeiden, habe ich das minimierte CSS nach dem Entfernen von Stilen, die nicht verwendet werden, inline gesetzt.

Ich w√ºrde mich freuen, wenn weitere Sprachen hinzugef√ºgt w√ºrden! Hier ist eine [Erkl√§rung, wie man zu Projekten beitr√§gt](https://docs.github.com/en/get-started/quickstart/contributing-to-projects). F√ºge einen neuen Ordner mit deinem Regionalcode in `src` hinzu, und erstelle die entsprechenden Templates in deiner Sprache. F√ºge dann noch das neue Navigations-Array zu `navigation.js`, die lokalisierten Strings zu `languages.js` und die Weiterleitungen zu `netlify.toml` hinzu.

Ganz zum Schluss eine kleine Entschuldigung: Ich kann mich nur in den englischsprachigen Begriffen ausdr√ºcken und habe noch nie ein deutsches Fachbuch √ºber Web-Technologien gelesen. Ich habe ich eine Menge seltsamer eingedeutschter Formulierungen verwendet oder manche Begriffe gar nicht erst versucht zu √ºbersetzten.

### Noch einige sehr gute Links zum Thema

- [YouTube: Internationalization (i18n), Eleventy üéà Weekly ‚Ññ16](https://youtube.com/watch?v=sfPNgt3joWI&t=1122)
- [Smashing Magazine: I18n And l10n For Static Sites](https://www.smashingmagazine.com/2020/11/internationalization-localization-static-sites/)
- [benmyers.dev: I Finally Understand Eleventy's Data Cascade](https://benmyers.dev/blog/eleventy-data-cascade/)
- [hoeser.dev: I18n of URLs](https://www.hoeser.dev/blog/2022-07-08-i18n-urls/)
- [YouTube: How a screen reader sounds without "lang" attribute defined](https://www.youtube.com/watch?v=QwOoU8T24UY)
- [w3.org: Language information and text direction](https://www.w3.org/TR/REC-html40/struct/dirlang.html)
